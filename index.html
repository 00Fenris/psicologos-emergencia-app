<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Psic√≥logos Emergencia</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="stylesheet" href="styles.css">
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="firebaseConfig.js"></script>
  <script src="app.js" defer></script>
</head>
<body>
  <!-- Bloque de login y registro -->
  <div id="login" class="center">
    <div class="login-container">
      <div class="login-header">
        <div class="logo">
          <div class="logo-icon">üß†</div>
          <h1>Psic√≥logos Emergencia</h1>
        </div>
        <p class="subtitle">Sistema de gesti√≥n de disponibilidad</p>
      </div>
      
      <div class="login-card">
        <div class="tab-container">
          <button class="tab active" id="tabPsicologo">Psic√≥logos</button>
          <button class="tab" id="tabAdmin">Administraci√≥n</button>
        </div>
        
        <!-- Panel Psic√≥logos -->
        <div id="panelPsicologo" class="tab-content active">
          <h2>Acceso Psic√≥logos</h2>
          <div class="form-group">
            <label for="emailLogin">Email</label>
            <input id="emailLogin" type="email" placeholder="tu@email.com" autocomplete="email" />
          </div>
          <div class="form-group">
            <label for="passwordLogin">Contrase√±a</label>
            <input id="passwordLogin" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" />
          </div>
          <button id="btnLogin" class="btn-primary">Iniciar Sesi√≥n</button>
          <button id="btnRegister" class="btn-secondary">Registrarse como Psic√≥logo</button>
          
          <!-- Campos adicionales para registro (ocultos por defecto) -->
          <div id="registerFields" class="register-fields" style="display:none;">
            <div class="form-group">
              <label for="emailRegister">Email para registro</label>
              <input id="emailRegister" type="email" placeholder="nuevo@email.com" />
            </div>
            <div class="form-group">
              <label for="passwordRegister">Contrase√±a</label>
              <input id="passwordRegister" type="password" placeholder="M√≠nimo 6 caracteres" />
            </div>
          </div>
        </div>
        
        <!-- Panel Administraci√≥n -->
        <div id="panelAdmin" class="tab-content">
          <h2>Panel Administrativo</h2>
          <div class="admin-options">
            <div class="admin-card">
              <div class="admin-icon">‚öôÔ∏è</div>
              <h3>Gesti√≥n del Sistema</h3>
              <p>Accede al panel de control completo</p>
              <button id="btnAdminAccess" class="btn-admin">Acceder al Panel</button>
            </div>
            <div class="admin-card">
              <div class="admin-icon">üë®‚Äçüíº</div>
              <h3>Login Coordinador</h3>
              <div class="form-group">
                <input id="coordEmailQuick" type="email" placeholder="Email coordinador" />
              </div>
              <div class="form-group">
                <input id="coordPasswordQuick" type="password" placeholder="Contrase√±a" />
              </div>
              <button id="btnLoginCoordQuick" class="btn-coord">Acceder</button>
            </div>
          </div>
        </div>
        
        <div id="loginError" class="error-message"></div>
      </div>
    </div>
  </div>

  <!-- Vista Psic√≥logo -->
  <div id="vistaPsicologo" class="hidden">
    <header>
      <h1>Registro de disponibilidad</h1>
      <button id="btnSalirPsicologo" style="float:right;background:#718096;">Salir</button>
    </header>
    <div class="card" style="max-width:400px;margin:0 auto;">
      <form id="formPsico1" autocomplete="off">
        <label for="nombre">Nombre completo</label>
        <input id="nombre1" name="nombre" type="text" required />
        <label for="telefono">Tel√©fono</label>
        <input id="telefono1" name="telefono" type="tel" placeholder="Ej: +34 600 123 456" required autocomplete="tel" />
        <label for="zona">Zona</label>
        <input id="zona1" name="zona" type="text" required autocomplete="off" />
        <div id="zona-sugerencias" class="sugerencias"></div>
        <label for="semana">Semana</label>
        <input id="semana1" name="semana" type="week" required autocomplete="off" />
        <label for="turno">Turno</label>
        <select id="turno1" name="turno" required>
          <option value="">-- Selecciona un turno --</option>
          <option>Ma√±ana</option>
          <option>Tarde</option>
          <option>Noche</option>
        </select>
        <label for="notas">Notas (opcional)</label>
        <input id="notas1" name="notas" type="text" autocomplete="off" />
        <button type="submit">Guardar</button>
      </form>
    </div>
    <div class="card" style="max-width:400px;margin:20px auto;">
      <h3>Chat con Coordinador</h3>
      <div id="chatPsico" class="chat"></div>
      <input id="msgPsico1" type="text" placeholder="Escribe tu mensaje..." style="width:80%" />
      <button id="btnSendPsico" class="small">Enviar</button>
    </div>
  </div>

  <!-- Vista Coordinador -->
  <div id="vistaCoordinador" class="hidden">
    <header>
      <h1>Coordinador ‚Äî Vista</h1>
      <button id="btnSalirCoordinador" style="float:right;background:#718096;">Salir</button>
    </header>
    <div class="card" style="max-width:600px;margin:0 auto;">
      <label for="filtroDia">Filtrar por d√≠a</label>
      <input id="filtroDia" type="date" />
      <label for="filtroZona">Filtrar por zona</label>
      <input id="filtroZona" type="text" autocomplete="off" />
      <div id="filtroZona-sugerencias" class="sugerencias"></div>
      <label for="filtroTurno">Filtrar por turno</label>
      <select id="filtroTurno">
        <option value="">-- Todos los turnos --</option>
        <option>Ma√±ana</option>
        <option>Tarde</option>
        <option>Noche</option>
      </select>
      <div style="display:flex;gap:8px;margin-top:10px">
        <button id="btnVerTodos" class="small">Ver todos</button>
        <button id="btnDescargarPDF" class="small" style="background:#38a169">Descargar PDF</button>
        <button id="btnBorrarTodo" class="small btn-borrar-todo">Borrar todo</button>
      </div>
      <hr />
      <div id="listadoContainer" style="max-height:460px;overflow:auto"></div>
    </div>
    <div class="card" style="max-width:600px;margin:20px auto;">
      <h3>Chat con Psic√≥logos</h3>
      <label for="filtroTurnoPsico">Filtrar psic√≥logos por turno:</label>
      <div id="filtroTurnoPsico" style="margin-bottom:10px;">
        <label><input type="checkbox" value="Ma√±ana"> Ma√±ana</label>
        <label><input type="checkbox" value="Tarde"> Tarde</label>
        <label><input type="checkbox" value="Noche"> Noche</label>
        <button id="btnFiltrarPsico" class="small">Aplicar Filtro</button>
      </div>
      <label for="selectPsico">Selecciona psic√≥logo:</label>
      <select id="selectPsico" style="width:100%;margin-bottom:10px"></select>
      <div id="chatCoord" class="chat"></div>
      <input id="msgCoord1" type="text" placeholder="Escribe tu mensaje..." style="width:80%" />
      <button id="btnSendCoord" class="small">Enviar</button>
    </div>
  </div>

  <!-- Panel Admin para Coordinadores -->
  <div id="panelAdmin" class="hidden">
    <header>
      <h1>Panel Administrativo - Coordinadores</h1>
      <button id="btnSalirAdmin" style="float:right;background:#718096;">Salir</button>
    </header>
    <div class="card" style="max-width:800px;margin:0 auto;">
      <h2>Gesti√≥n de Coordinadores</h2>
      <div style="display:flex;gap:20px;margin-bottom:20px;">
        <div style="flex:1;">
          <h3>Registrar Nuevo Coordinador</h3>
          <input id="adminEmail" type="email" placeholder="Email del coordinador" style="width:100%;margin-bottom:10px;" />
          <input id="adminPassword" type="password" placeholder="Contrase√±a" style="width:100%;margin-bottom:10px;" />
          <button id="btnCrearCoordinador" style="background:#38a169;">Crear Coordinador</button>
          <div id="adminError" style="color:red;margin-top:10px;"></div>
        </div>
        <div style="flex:1;">
          <h3>Login Coordinador</h3>
          <input id="coordEmail" type="email" placeholder="Email coordinador" style="width:100%;margin-bottom:10px;" />
          <input id="coordPassword" type="password" placeholder="Contrase√±a" style="width:100%;margin-bottom:10px;" />
          <button id="btnLoginCoord" style="background:#4299e1;">Acceder como Coordinador</button>
        </div>
      </div>
      <div style="margin-top:30px;">
        <h3>Estad√≠sticas</h3>
        <div id="statsPanel" style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px;">
          <div class="stat-card">
            <h4>Psic√≥logos Registrados</h4>
            <div id="statPsicologos" style="font-size:2em;color:#38a169;">0</div>
          </div>
          <div class="stat-card">
            <h4>Coordinadores</h4>
            <div id="statCoordinadores" style="font-size:2em;color:#4299e1;">0</div>
          </div>
          <div class="stat-card">
            <h4>Registros Esta Semana</h4>
            <div id="statSemana" style="font-size:2em;color:#ed8936;">0</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
